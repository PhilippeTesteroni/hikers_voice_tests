# Hiker's Voice ‚Äî –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

> **–ú–∏–Ω–∏–º—É–º —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è, –º–∞–∫—Å–∏–º—É–º —è—Å–Ω–æ—Å—Ç–∏.** –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º–∏ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ –ø—Ä–æ–¥.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤](#—Å—Ç–∞—Ç—É—Å-—Ç–µ—Å—Ç–æ–≤-)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-)
  - [Page Object Pattern](#page-object-pattern)
  - [–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã](#–∫–ª—é—á–µ–≤—ã–µ-–ø–∞—Ç—Ç–µ—Ä–Ω—ã)
  - [–°–∏—Å—Ç–µ–º–∞ cleanup](#—Å–∏—Å—Ç–µ–º–∞-cleanup)
  - [–†–∞–±–æ—Ç–∞ —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-–∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞–º–∏)
  - [–ú–æ–¥–µ—Ä–∞—Ü–∏—è](#–º–æ–¥–µ—Ä–∞—Ü–∏—è)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞-)
- [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤-)
- [–¢–µ—Å—Ç—ã –≤ –¥–µ—Ç–∞–ª—è—Ö](#—Ç–µ—Å—Ç—ã-–≤-–¥–µ—Ç–∞–ª—è—Ö-)
- [–û—Ç–ª–∞–¥–∫–∞](#–æ—Ç–ª–∞–¥–∫–∞-)
- [–ß–µ–∫–ª–∏—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–∞](#—á–µ–∫–ª–∏—Å—Ç-—Å–æ–∑–¥–∞–Ω–∏—è-—Ç–µ—Å—Ç–∞-)

---

## –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤ ‚úÖ

| ID | –¢–µ—Å—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª |
|----|------|----------|--------|------|
| **TEST-001** | –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é | –û—Ç–∑—ã–≤ —á–µ—Ä–µ–∑ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç, –º–æ–¥–µ—Ä–∞—Ü–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –∏ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ–º–ø–∞–Ω–∏–∏ | ‚úÖ | `test_reviews.py::test_create_company_review_with_autocomplete_refactored` |
| **TEST-002** | –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –≥–∏–¥–∞ | –ê–Ω–æ–Ω–∏–º–Ω—ã–π –æ—Ç–∑—ã–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å | ‚úÖ | `test_reviews.py::test_create_guide_review_with_autocomplete_refactored` |
| **TEST-003** | –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ | –ü–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞ + –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ + –≤–∞–ª–∏–¥–∞—Ü–∏—è | ‚úÖ | `test_companies.py::test_create_new_company` |
| **TEST-004** | –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–∞ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ —Ç–µ–∫—Å—Ç–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π, –ø—Ä–∞–≤–∏–ª | ‚úÖ | `test_reviews.py::test_review_form_validation_errors` |
| **TEST-005** | –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π | 1-5 —Ñ–æ—Ç–æ, –ø—Ä–µ–≤—å—é, –≥–∞–ª–µ—Ä–µ—è, lightbox –Ω–∞–≤–∏–≥–∞—Ü–∏—è | ‚úÖ | `test_photo_upload.py::test_review_with_photos_refactored` |
| **TEST-006** | –î—É–±–ª–∏–∫–∞—Ç –∫–æ–º–ø–∞–Ω–∏–∏ | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –Ω–∞–≤–∏–≥–∞—Ü–∏—è | ‚úÖ | `test_companies.py::test_duplicate_company_detection_and_navigation` |
| **TEST-007** | –î—É–±–ª–∏–∫–∞—Ç –≥–∏–¥–∞ (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω) | –î–≤–µ –æ–ø—Ü–∏–∏: –ø–µ—Ä–µ–π—Ç–∏ / —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π | ‚úÖ | `test_guides.py::test_duplicate_guide_detection_and_navigation` |
| **TEST-008** | –ì–∏–¥ –±–µ–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω | –û–¥–Ω–æ –∏–º—è, —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã ‚Üí —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ | ‚úÖ | `test_guides.py::test_create_guide_same_name_no_country_overlap` |
| **TEST-009** | Lookup —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π | –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω—ã + –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –¥—É–±–ª–µ–π | ‚úÖ | `test_lookup.py::test_guide_lookup_extended_info` |
| **TEST-010** | –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å—É—â–Ω–æ—Å—Ç–∏ | 3 –æ—Ç–∑—ã–≤–∞ √ó 5 —Ñ–æ—Ç–æ = 15, lightbox, —Å—á—ë—Ç—á–∏–∫, –Ω–∞–≤–∏–≥–∞—Ü–∏—è | ‚úÖ | `test_entity_photo_gallery.py::test_entity_photo_gallery` |
| **TEST-011** | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º –∫–ª—é—á–æ–º | –ö–æ–º–ø–∞–Ω–∏—è/–≥–∏–¥: –ø–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Å—Ç–∞ –∏ –¥–∞–Ω–Ω—ã—Ö | ‚úÖ | `test_entity_edit.py::test_edit_entity_with_valid_key` |
| **TEST-012** | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –∫–ª—é—á–æ–º | –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –Ω–µ–≤–µ—Ä–Ω—ã–º UUID ‚Üí –∫—Ä–∞—Å–Ω—ã–π —Ç–æ—Å—Ç —Å –æ—à–∏–±–∫–æ–π | ‚úÖ | `test_entity_edit.py::test_edit_entity_with_invalid_key` |
| **TEST-013** | –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –∫–ª—é—á–∞ | –ü—É—Å—Ç–æ–µ –ø–æ–ª–µ, —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π UUID ‚Üí –∫–Ω–æ–ø–∫–∞ disabled –∏–ª–∏ –æ—à–∏–±–∫–∞ | ‚úÖ | `test_entity_edit.py::test_edit_attempt_with_invalid_format` |

**–í—Å–µ–≥–æ:** 13 —Ç–µ—Å—Ç–æ–≤, –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ üèó

### Page Object Pattern

–í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å UI –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ Page Objects. –°–µ–ª–µ–∫—Ç–æ—Ä—ã ‚Äî –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞, –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ (–Ω–µ –¥–µ–ª–∞—é—Ç assert).

```python
# pages/home_page.py
class HomePage(BasePage):
    # –°–µ–ª–µ–∫—Ç–æ—Ä—ã
    LEAVE_REVIEW_BTN = "button:has-text('–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤')"
    REVIEW_CARD = "[data-testid='review-card']"
    
    # –ú–µ—Ç–æ–¥—ã
    async def click_leave_review(self):
        await self.page.click(self.LEAVE_REVIEW_BTN)
    
    async def find_review_by_author(self, name: str):
        # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∞ –Ω–µ –¥–µ–ª–∞–µ—Ç assert
        cards = await self.page.locator(self.REVIEW_CARD).all()
        for card in cards:
            author = await card.locator(".author-name").text_content()
            if name in author:
                return card
        return None
```

**BasePage** (`pages/base_page.py`) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- `wait_for_load()` ‚Äî –∂–¥—ë—Ç `networkidle` + React hydration + —à—Ä–∏—Ñ—Ç—ã
- `click_and_wait()` ‚Äî –∫–ª–∏–∫ + –æ–∂–∏–¥–∞–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏/—Å–µ–ª–µ–∫—Ç–æ—Ä–∞
- `fill_and_validate()` ‚Äî –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ + –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è
- `wait_for_condition()` ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏—è —Å polling

**–ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:**
```
BasePage
‚îú‚îÄ‚îÄ HomePage (–≥–ª–∞–≤–Ω–∞—è, —Å–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤)
‚îú‚îÄ‚îÄ CompanyPage (–∫–æ–º–ø–∞–Ω–∏–∏: —Å–ø–∏—Å–æ–∫, –¥–µ—Ç–∞–ª–∏, —Å–æ–∑–¥–∞–Ω–∏–µ)
‚îú‚îÄ‚îÄ GuidePage (–≥–∏–¥—ã: —Å–ø–∏—Å–æ–∫, –¥–µ—Ç–∞–ª–∏, —Å–æ–∑–¥–∞–Ω–∏–µ)
‚îú‚îÄ‚îÄ ReviewFormPage (—Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–æ–≤ + –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç—ã + —Ñ–æ—Ç–æ)
‚îî‚îÄ‚îÄ ReviewsPage (–¥–µ—Ç–∞–ª–∏ –æ—Ç–∑—ã–≤–∞ + —Ñ–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è + lightbox)
```

---

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### 1. **AAA (Arrange-Act-Assert)**

```python
async def test_example(page, clean_test_company):
    # Arrange
    company = await frontend_api_client.create_company(...)
    clean_test_company.append(company["id"])
    
    # Act
    await home_page.open()
    await home_page.click_leave_review()
    # ...
    
    # Assert
    assert "success=review_created" in page.url
    assert rating == expected_rating
```

#### 2. **–õ–∏–Ω–µ–π–Ω–æ—Å—Ç—å ‚Äî –Ω–∏–∫–∞–∫–∏—Ö –≤–µ—Ç–≤–ª–µ–Ω–∏–π**

```python
# ‚ùå –ù–ï –¢–ê–ö
if await element.is_visible():
    # do something
else:
    # fallback

# ‚úÖ –¢–ê–ö
await element.wait_for(state="visible", timeout=10000)
# continue
```

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ‚Äî **–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ `@pytest.mark.parametrize`.

#### 3. **–ù–∏–∫–∞–∫–∏—Ö time.sleep()**

```python
# ‚ùå –ù–ï –¢–ê–ö
await page.wait_for_timeout(2000)

# ‚úÖ –¢–ê–ö
await page.wait_for_selector(DROPDOWN, state="visible")
await page.wait_for_load_state("networkidle")
```

–ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –∫–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è debounce (300-500ms).

#### 4. **–§–∏–∫—Å—Ç—É—Ä—ã –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤**

```python
# ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Å—Ç—É—Ä—ã
async def test_example(page: Page, review_test_data: dict):
    data = review_test_data["valid"]["tour_review"]
    # ...

# ‚ùå –ù–ï —Å–æ–∑–¥–∞—ë–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ —Ç–µ—Å—Ç–µ
async def test_bad():
    page = await browser.new_page()  # WRONG!
```

#### 5. **–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å retry**

```python
# ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –±–µ–∑ reload
success = await base_page.wait_for_condition(
    check_fn=lambda: company_page.get_reviews_count() > 0,
    timeout=10000,
    error_message="Reviews did not appear"
)
assert success

# ‚úÖ –° reload –¥–ª—è ISR –∫–µ—à–∞ (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ)
success = await base_page.wait_for_condition(
    check_fn=lambda: company_page.get_reviews_count() > 0,
    timeout=30000,
    interval=5000,
    retry_with_reload=True,  # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
    error_message="Reviews did not appear after retries"
)
assert success
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `retry_with_reload=True`:**
- –ü–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–∞ (ISR –∫–µ—à –º–æ–∂–µ—Ç –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è —Å—Ä–∞–∑—É)
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏/–≥–∏–¥–∞
- –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
- –í –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å—Å—è

---

### –°–∏—Å—Ç–µ–º–∞ cleanup

**–ü—Ä–∞–≤–∏–ª–æ:** Cleanup –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–≤ —Ñ–∏–∫—Å—Ç—É—Ä–∞—Ö**, –∞ –Ω–µ –≤ —Ç–µ–ª–µ —Ç–µ—Å—Ç–∞. –ï—Å–ª–∏ cleanup –ø–∞–¥–∞–µ—Ç ‚Äî —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –º—É—Å–æ—Ä–∞ –≤ –ë–î).

#### –§–∏–∫—Å—Ç—É—Ä—ã cleanup

##### `clean_test_review` ‚Äî –æ—Ç–∑—ã–≤—ã

```python
@pytest_asyncio.fixture
async def clean_test_review(backend_url: str):
    review_ids = []
    yield review_ids
    # Teardown: —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ admin API
    for review_id in review_ids:
        response = await client.post(f"/admin/review/{review_id}/delete", headers=auth_headers)
        if response.status_code not in [303, 404]:
            pytest.fail(f"CLEANUP FAILED: review {review_id}")
```

**–ö—Ä–µ–¥—ã –∞–¥–º–∏–Ω–∞:**
```python
ADMIN_USERNAME = "Philippe_testeroni"  # ‚Üê –ó–ê–ì–õ–ê–í–ù–ê–Ø P!
ADMIN_PASSWORD = "KeklikG0nnaKek!"
```

##### `clean_test_company` ‚Äî –∫–æ–º–ø–∞–Ω–∏–∏

```python
@pytest_asyncio.fixture
async def clean_test_company(backend_url: str):
    company_ids = []
    yield company_ids
    # Teardown: DELETE /api/v1/test/companies/{id}
    for company_id in company_ids:
        deleted = await test_helper.delete_company(company_id)
        if not deleted:
            pytest.fail(f"CLEANUP FAILED: company {company_id}")
```

##### `clean_test_guide` ‚Äî –≥–∏–¥—ã

```python
@pytest_asyncio.fixture
async def clean_test_guide(backend_url: str):
    guide_ids = []
    yield guide_ids
    # Teardown: DELETE /api/v1/test/guides/{id}
    for guide_id in guide_ids:
        deleted = await test_helper.delete_guide(guide_id)
        if not deleted:
            pytest.fail(f"CLEANUP FAILED: guide {guide_id}")
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö

```python
async def test_example(clean_test_review: list, clean_test_company: list):
    # –°–æ–∑–¥–∞—ë–º –∫–æ–º–ø–∞–Ω–∏—é
    company = await frontend_api_client.create_company(...)
    clean_test_company.append(company["id"])  # ‚Üê –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –¥–ª—è cleanup
    
    # –°–æ–∑–¥–∞—ë–º –æ—Ç–∑—ã–≤
    review_id = await create_review(...)
    clean_test_review.append(review_id)  # ‚Üê –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –¥–ª—è cleanup
    
    # –¢–µ—Å—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è...
    # –í teardown —Ñ–∏–∫—Å—Ç—É—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç –≤—Å—ë
```

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ cleanup –ø–∞–¥–∞–µ—Ç ‚Äî —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç. –ù–∏–∫–∞–∫–∏—Ö fallback'–æ–≤.

---

### –†–∞–±–æ—Ç–∞ —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞–º–∏

–í—Å–µ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç—ã –∏–º–µ—é—Ç **debounce 300ms**. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```python
async def type_and_wait_dropdown(self, text: str):
    # 1. –ö–ª–∏–∫ –ø–æ input (—Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç onFocus)
    await input.click()
    await self.page.wait_for_timeout(300)
    
    # 2. –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –º–µ–∂–¥—É —Å–∏–º–≤–æ–ª–∞–º–∏
    await input.type(text, delay=100)
    
    # 3. –û–∂–∏–¥–∞–Ω–∏–µ debounce + API
    await self.page.wait_for_timeout(500)
    
    # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è dropdown
    await self.page.wait_for_selector(DROPDOWN, state="visible")
```

**–í–∞–∂–Ω–æ:**
- –ö–ª–∏–∫ **–ø–µ—Ä–µ–¥** –≤–≤–æ–¥–æ–º
- –û–∂–∏–¥–∞–Ω–∏–µ `state="visible"` (–Ω–µ `attached`)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ API –∑–∞–ø—Ä–æ—Å

#### –°–µ–ª–µ–∫—Ç–æ—Ä dropdown

```python
# –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–±–µ–∏–º–∏ —Ç–µ–º–∞–º–∏)
DROPDOWN = "div.absolute.z-10[class*='bg-']"

# ‚ùå –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç
DROPDOWN = ".dropdown"  # –Ω–µ—Ç —Ç–∞–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞
DROPDOWN = "ul"         # —Å–ª–∏—à–∫–æ–º –æ–±—â–∏–π
```

---

### –ú–æ–¥–µ—Ä–∞—Ü–∏—è

#### –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤

–û—Ç–∑—ã–≤—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending_rate_limited` **–±–µ–∑** –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Å—É—â–Ω–æ—Å—Ç–∏ (`company_id`/`guide_id` = NULL). –ü—Ä–∏–≤—è–∑–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Ç–æ–ª—å–∫–æ** –ø—Ä–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏.

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û ‚Äî –ø–æ–∏—Å–∫ –ø–æ company_id –¥–æ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
review_id = await find_review(company_id=company_id)

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –ø–æ author_name
review_id = await test_helper.find_and_moderate_review(
    author_name="Test User *20250104_153045*",  # —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Å timestamp
    action="approve",
    company_id=company_id  # –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ü–û–°–õ–ï –º–æ–¥–µ—Ä–∞—Ü–∏–∏
)
```

**Endpoint:** `POST /api/v1/test/moderate/{review_id}?action=approve`

**–≠—Ñ—Ñ–µ–∫—Ç—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏:**
- –°—Ç–∞—Ç—É—Å ‚Üí `approved`
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–º–ø–∞–Ω–∏–∏/–≥–∏–¥—É (`company_id`/`guide_id`)
- –ü–µ—Ä–µ—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞
- ISR –∫—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (~1 —Å–µ–∫—É–Ω–¥–∞)

#### –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π

**–û—Ç–∑—ã–≤—ã:**
```python
# –ß–µ—Ä–µ–∑ admin –ø–∞–Ω–µ–ª—å —Å Basic Auth
POST /admin/review/{review_id}/delete
Authorization: Basic <base64(Philippe_testeroni:KeklikG0nnaKek!)>

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: 303 See Other (—Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è)
```

**–ö–æ–º–ø–∞–Ω–∏–∏ –∏ –≥–∏–¥—ã:**
```python
# –ß–µ—Ä–µ–∑ test API (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
DELETE /api/v1/test/companies/{company_id}
DELETE /api/v1/test/guides/{guide_id}

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: 200 OK –∏–ª–∏ 204 No Content
```

**–í–∞–∂–Ω–æ:**
- –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏/–≥–∏–¥–∞ ‚Üí –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –í —Ç–µ—Å—Ç–∞—Ö cleanup –∏–¥—ë—Ç –≤ –ø–æ—Ä—è–¥–∫–µ: reviews ‚Üí companies/guides

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ üìÅ

```
hikers_voice_tests/
‚îú‚îÄ‚îÄ conftest.py              # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ pytest.ini               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ pytest (–º–∞—Ä–∫–µ—Ä—ã, –ª–æ–≥–∏)
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md                # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ pages/                   # Page Objects
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ base_page.py        # BasePage —Å wait/click/fill –º–µ—Ç–æ–¥–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ home_page.py        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ + —Å–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ company_page.py     # –ö–æ–º–ø–∞–Ω–∏–∏: —Å–ø–∏—Å–æ–∫, –¥–µ—Ç–∞–ª–∏, —Å–æ–∑–¥–∞–Ω–∏–µ, –¥—É–±–ª–∏–∫–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ guide_page.py       # –ì–∏–¥—ã: —Å–ø–∏—Å–æ–∫, –¥–µ—Ç–∞–ª–∏, —Å–æ–∑–¥–∞–Ω–∏–µ, –¥—É–±–ª–∏–∫–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ review_form_page.py # –§–æ—Ä–º—ã –æ—Ç–∑—ã–≤–æ–≤ + –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç—ã + –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
‚îÇ   ‚îî‚îÄ‚îÄ reviews_page.py     # –î–µ—Ç–∞–ª–∏ –æ—Ç–∑—ã–≤–∞ + —Ñ–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è + lightbox
‚îÇ
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py         # E2E —Ñ–∏–∫—Å—Ç—É—Ä—ã (browser, clean_test_*)
‚îÇ   ‚îú‚îÄ‚îÄ test_reviews.py     # TEST-001, 002, 004 (—Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ test_companies.py   # TEST-003, 006 (—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, –¥—É–±–ª–∏–∫–∞—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ test_guides.py      # TEST-007, 008 (–¥—É–±–ª–∏–∫–∞—Ç—ã –≥–∏–¥–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ test_lookup.py      # TEST-009 (–∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π)
‚îÇ   ‚îú‚îÄ‚îÄ test_photo_upload.py        # TEST-005 (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ)
‚îÇ   ‚îú‚îÄ‚îÄ test_entity_photo_gallery.py # TEST-010 (–≥–∞–ª–µ—Ä–µ—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—É—â–Ω–æ—Å—Ç–∏)
‚îÇ   ‚îî‚îÄ‚îÄ test_entity_edit.py # TEST-011, 012, 013 (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–π/–≥–∏–¥–æ–≤)
‚îÇ
‚îú‚îÄ‚îÄ fixtures/                # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ test_data.py        # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö (generate_company_data, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ test_images_fixtures.py  # –§–∏–∫—Å—Ç—É—Ä–∞ test_images
‚îÇ   ‚îî‚îÄ‚îÄ test_images/        # –ü–∞–ø–∫–∞ —Å–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
‚îÇ
‚îî‚îÄ‚îÄ utils/                   # –£—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ test_helper.py      # TestHelper (–º–æ–¥–µ—Ä–∞—Ü–∏—è, —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API)
    ‚îú‚îÄ‚îÄ frontend_api_client.py  # –°–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ API
    ‚îú‚îÄ‚îÄ image_generator.py  # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    ‚îî‚îÄ‚îÄ rating_calculator.py # –†–∞—Å—á—ë—Ç —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
```

---

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ üöÄ

### –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è

1. **Backend:** `http://localhost:8000` (APP_ENV=dev)
2. **Frontend:** `http://localhost:3000`
3. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   pip install -r requirements.txt
   ```
4. **–¢–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   ```bash
   python utils/image_generator.py
   ```

### –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest tests/ -v

# –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
pytest tests/test_reviews.py -v      # –û—Ç–∑—ã–≤—ã
pytest tests/test_companies.py -v    # –ö–æ–º–ø–∞–Ω–∏–∏
pytest tests/test_guides.py -v       # –ì–∏–¥—ã
pytest tests/test_lookup.py -v       # Lookup
pytest tests/test_photo_upload.py -v # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
pytest tests/test_entity_photo_gallery.py -v # –ì–∞–ª–µ—Ä–µ—è
pytest tests/test_entity_edit.py -v  # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

# –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π ‚Äî –æ–¥–∏–Ω —Å—Ü–µ–Ω–∞—Ä–∏–π
pytest tests/test_lookup.py -k "guide_review" -v
pytest tests/test_guides.py -k "go_to_existing" -v

# –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest -m critical

# –° –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π
pytest tests/ --slow-mo=500

# Headless (CI)
pytest tests/ --headless

# –û–¥–∏–Ω —Ç–µ—Å—Ç
pytest tests/test_reviews.py::test_create_company_review_with_autocomplete_refactored -v
```

### –û–ø—Ü–∏–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```bash
--headless          # Headless —Ä–µ–∂–∏–º (default: True)
--slow-mo=N         # –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (default: 100ms)
--env=ENV           # –û–∫—Ä—É–∂–µ–Ω–∏–µ: local, staging, prod (default: local)
```

---

## –¢–µ—Å—Ç—ã –≤ –¥–µ—Ç–∞–ª—è—Ö üîç

### TEST-001, 002: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–æ–º

**–§–∞–π–ª:** `test_reviews.py`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** `rating=[1, 5]` (boundary values)

**–°—Ü–µ–Ω–∞—Ä–∏–π (–∫–æ–º–ø–∞–Ω–∏—è):**
1. –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é —á–µ—Ä–µ–∑ API
2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –æ—Ç–∑—ã–≤–∞
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç (–ø–æ–∏—Å–∫ –ø–æ –ø–µ—Ä–≤—ã–º 10 —Å–∏–º–≤–æ–ª–∞–º, –≤—ã–±–æ—Ä —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è)
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É
5. –ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ API
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ–º–ø–∞–Ω–∏–∏ (–Ω–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è ‚Üí rating = 1 –∏–ª–∏ 5, reviews = 1)

**–°—Ü–µ–Ω–∞—Ä–∏–π (–≥–∏–¥):**
- –ê–Ω–æ–Ω–∏–º–Ω—ã–π –∞–≤—Ç–æ—Ä (–ø—É—Å—Ç–æ–µ –∏–º—è ‚Üí "–ê–Ω–æ–Ω–∏–º")
- –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ (—Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ)
- –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –≥–∏–¥–∞ —á–µ—Ä–µ–∑ API

**Cleanup:** `clean_test_review`, `clean_test_company`, `clean_test_guide`

**–í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:**
- –ê–≤—Ç–æ—Ä —Å timestamp (`*20250104_153045*`) –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç: –ø–æ–∏—Å–∫ –ø–æ 10 —Å–∏–º–≤–æ–ª–∞–º, –≤—ã–±–æ—Ä –ø–æ–ª–Ω–æ–≥–æ –∏–º–µ–Ω–∏
- ISR –∫—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

### TEST-003: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏

**–§–∞–π–ª:** `test_companies.py`

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
1. `test_create_new_company` ‚Äî –ø–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞ (–≤—Å–µ –ø–æ–ª—è)
2. `test_create_company_minimal_data` ‚Äî —Ç–æ–ª—å–∫–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
3. `test_company_validation_errors` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π (–ø–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞):**
1. –û—Ç–∫—Ä—ã—Ç—å `/companies`
2. –ö–ª–∏–∫ "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –ø–æ–ª—è (–∏–º—è, —Å—Ç—Ä–∞–Ω–∞, –æ–ø–∏—Å–∞–Ω–∏–µ, email, —Ç–µ–ª–µ—Ñ–æ–Ω, —Å–∞–π—Ç, Instagram, Telegram)
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å
5. –ü–æ–ª—É—á–∏—Ç—å `company_id` –∏–∑ success —Å–æ–æ–±—â–µ–Ω–∏—è
6. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ

**Cleanup:** `clean_test_company`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö–æ–º–ø–∞–Ω–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å—Ä–∞–∑—É —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `approved` (–º–æ–¥–µ—Ä–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞)
- Instagram/Telegram: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ `@` –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏

---

### TEST-004: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–∞

**–§–∞–π–ª:** `test_reviews.py`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** `review_type=["company", "guide"]`

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
1. –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å" –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –ø—É—Å—Ç–æ–π —Ñ–æ—Ä–º–µ
2. –ú–∏–Ω–∏–º—É–º —Ç–µ–∫—Å—Ç–∞: 10 —Å–∏–º–≤–æ–ª–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É)
3. –ú–∞–∫—Å–∏–º—É–º —Ç–µ–∫—Å—Ç–∞: 4000 —Å–∏–º–≤–æ–ª–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É)
4. –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã + –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–Ω—è—Ç—ã
5. –°–Ω—è—Ç–∏–µ –≥–∞–ª–æ—á–∫–∏ "–ü—Ä–∞–≤–∏–ª–∞" ‚Üí –∫–Ω–æ–ø–∫–∞ —Å–Ω–æ–≤–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**Cleanup:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (—Ñ–æ—Ä–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è)

---

### TEST-005: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –æ—Ç–∑—ã–≤—ã

**–§–∞–π–ª:** `test_photo_upload.py`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:**
- `review_type=["company", "guide"]`
- `photo_count=[1, 5]` (boundary values)

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ API
2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É –æ—Ç–∑—ã–≤–∞
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å N —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–µ–≤—å—é –≤ —Ñ–æ—Ä–º–µ (N –º–∏–Ω–∏–∞—Ç—é—Ä)
5. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É (timeout —É–≤–µ–ª–∏—á–µ–Ω –¥–ª—è 5 —Ñ–æ—Ç–æ)
6. –ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤
7. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–∑—ã–≤–∞
8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∞–ª–µ—Ä–µ—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (N —Ñ–æ—Ç–æ)
9. –û—Ç–∫—Ä—ã—Ç—å lightbox
10. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ "1 / N"
11. –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥
12. –ó–∞–∫—Ä—ã—Ç—å lightbox

**Cleanup:** `clean_test_review`, `clean_test_company`, `clean_test_guide`

**–í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:**
- Timeout –¥–ª—è submit: 30s –µ—Å–ª–∏ 5 —Ñ–æ—Ç–æ, 15s –µ—Å–ª–∏ 1 —Ñ–æ—Ç–æ
- –û–∂–∏–¥–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ –Ω–∞ –¥–∏—Å–∫: `photo_count * 2000ms`

---

### TEST-006: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏

**–§–∞–π–ª:** `test_companies.py`

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—é —á–µ—Ä–µ–∑ API
2. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—é —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º —á–µ—Ä–µ–∑ UI
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (HTTP 409)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥–≤—É—Ö –∫–Ω–æ–ø–æ–∫:
   - "–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–æ–º–ø–∞–Ω–∏–∏"
   - "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞"
5. –ö–ª–∏–∫ "–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–æ–º–ø–∞–Ω–∏–∏"
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–º–ø–∞–Ω–∏–∏
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–º—è —Å–æ–≤–ø–∞–¥–∞–µ—Ç

**Cleanup:** `clean_test_company`

---

### TEST-007: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–∞ –≥–∏–¥–∞ (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω)

**–§–∞–π–ª:** `test_guides.py`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** `action=["go_to_existing", "create_new"]`

**–°—Ü–µ–Ω–∞—Ä–∏–π (–æ–±—â–µ–µ –Ω–∞—á–∞–ª–æ):**
1. –°–æ–∑–¥–∞—Ç—å –≥–∏–¥–∞ —á–µ—Ä–µ–∑ API (—Å—Ç—Ä–∞–Ω—ã: GE, AM)
2. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å –≥–∏–¥–∞ —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º –∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–µ–π—Å—è —Å—Ç—Ä–∞–Ω–æ–π (GE)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —Å –∫–∞—Ä—Ç–æ—á–∫–æ–π –≥–∏–¥–∞
4. –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   - –ò–º—è –≥–∏–¥–∞
   - –°—Ç—Ä–∞–Ω—ã (–∑–Ω–∞—á–∫–∏)
   - –†–µ–π—Ç–∏–Ω–≥
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤
   - –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–°—Ü–µ–Ω–∞—Ä–∏–π A (go_to_existing):**
5. –ö–ª–∏–∫ "–î–∞, –ø–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–æ—Ñ–∏–ª—é"
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é `/guides/{guide_id}`
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è –≥–∏–¥–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π B (create_new):**
5. –ö–ª–∏–∫ "–ù–µ—Ç, —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π"
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å success —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º `guide_id`
7. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/guides` –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–±–∞ –≥–∏–¥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç

**Cleanup:** `clean_test_guide`

---

### TEST-008: –°–æ–∑–¥–∞–Ω–∏–µ –≥–∏–¥–∞ –±–µ–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω

**–§–∞–π–ª:** `test_guides.py`

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞—Ç—å –≥–∏–¥–∞ —á–µ—Ä–µ–∑ API (—Å—Ç—Ä–∞–Ω—ã: GE, AM)
2. –°–æ–∑–¥–∞—Ç—å –≥–∏–¥–∞ —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º, –Ω–æ **–¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω–æ–π** (TR)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ **–ù–ï** –ø–æ—è–≤–ª—è–µ—Ç—Å—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å success —Å–æ–æ–±—â–µ–Ω–∏–µ
5. –ü–æ–ª—É—á–∏—Ç—å `guide_id`

**Cleanup:** `clean_test_guide`

**–í–∞–∂–Ω–∞—è –¥–µ—Ç–∞–ª—å:** –î—É–±–ª–∏–∫–∞—Ç—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –ø—Ä–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω.

---

### TEST-009: Lookup —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

**–§–∞–π–ª:** `test_lookup.py`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** `form_type=["guide_review", "company_review"]`

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞—Ç—å –¥–≤–∞ –≥–∏–¥–∞ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º, –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∞–º–∏ (GE –∏ TR)
2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –æ—Ç–∑—ã–≤–∞ (–Ω–∞ –≥–∏–¥–∞ –∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏—é)
3. –í–≤–µ—Å—Ç–∏ —á–∞—Å—Ç—å –∏–º–µ–Ω–∏ –≥–∏–¥–∞ –≤ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç
4. –î–æ–∂–¥–∞—Ç—å—Å—è –ø–æ—è–≤–ª–µ–Ω–∏—è dropdown
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ dropdown –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∏–Ω–∏–º—É–º 2 –≥–∏–¥–∞
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:
   ```
   –ò–º—è –≥–∏–¥–∞
   üåç –°—Ç—Ä–∞–Ω–∞1, –°—Ç—Ä–∞–Ω–∞2 [‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç | –†–µ–π—Ç–∏–Ω–≥]
   ```
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `line2` (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è) —É –≥–∏–¥–æ–≤ **—Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è**
8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ "–ì—Ä—É–∑–∏—è" –∏ "–¢—É—Ä—Ü–∏—è" –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**Cleanup:** `clean_test_guide`

**–í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:**
- –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`GuideAutocomplete` vs `GuidesSelector`)
- –ü–∞—Ä–∞–º–µ—Ç—Ä `form_type` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π placeholder

---

### TEST-010: –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—É—â–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `test_entity_photo_gallery.py`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** `entity_type=["guide", "company"]`

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ API
2. –°–æ–∑–¥–∞—Ç—å **3 –æ—Ç–∑—ã–≤–∞** —Å **5 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏** –∫–∞–∂–¥—ã–π (–∏—Ç–æ–≥–æ 15 —Ñ–æ—Ç–æ)
3. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—É—â–Ω–æ—Å—Ç–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≥–∞–ª–µ—Ä–µ–∏: "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏–∑ –æ—Ç–∑—ã–≤–æ–≤ (15)"
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ **6 –º–∏–Ω–∏–∞—Ç—é—Ä**
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–≤–µ—Ä–ª–µ–π –Ω–∞ 6-–π –º–∏–Ω–∏–∞—Ç—é—Ä–µ: "+9"
7. –ö–ª–∏–∫ –Ω–∞ –ø–µ—Ä–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é ‚Üí –æ—Ç–∫—Ä—ã—Ç—å lightbox
8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—á—ë—Ç—á–∏–∫: "1 / 15"
9. –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–ø–µ—Ä—ë–¥: 2, 3, 4, 5
10. –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥: 4
11. –ó–∞–∫—Ä—ã—Ç—å lightbox

**Cleanup:** `clean_test_review`, `clean_test_company`, `clean_test_guide`

**–í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:**
- –ì–∞–ª–µ—Ä–µ—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 6 –º–∏–Ω–∏–∞—Ç—é—Ä
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ —Å–∫—Ä—ã—Ç—ã –∑–∞ –æ–≤–µ—Ä–ª–µ–µ–º (total - 6 = remaining)
- Lightbox: –∫–Ω–æ–ø–∫–∏ `[aria-label='–°–ª–µ–¥—É—é—â–µ–µ —Ñ–æ—Ç–æ']` –∏ `[aria-label='–ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Ñ–æ—Ç–æ']`

---

### TEST-011, 012, 013: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π

**–§–∞–π–ª:** `test_entity_edit.py`

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Å–µ–∫—Ü–∏–∏ [–¢–µ—Å—Ç—ã –≤ –¥–µ—Ç–∞–ª—è—Ö](#—Ç–µ—Å—Ç—ã-–≤-–¥–µ—Ç–∞–ª—è—Ö-) –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ README (—Å–ª–∏—à–∫–æ–º –æ–±—ä—ë–º–Ω–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ–≥–æ –∏–∑–ª–æ–∂–µ–Ω–∏—è).

---

## –û—Ç–ª–∞–¥–∫–∞ üîß

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| Dropdown –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è | –ù–µ—Ç –∫–ª–∏–∫–∞ –ø–µ—Ä–µ–¥ –≤–≤–æ–¥–æ–º | `await input.click()` –ø–µ—Ä–µ–¥ `input.type()` |
| Timeout –Ω–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä | –°–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ–≤–µ—Ä–Ω—ã–π | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ DevTools (F12) |
| Cleanup –ø–∞–¥–∞–µ—Ç | APP_ENV != dev | `export APP_ENV=dev` –≤ backend |
| ModuleNotFoundError PIL | Pillow –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω | `pip install Pillow` |
| –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –Ω–µ —Ç—É —Å—É—â–Ω–æ—Å—Ç—å | –ù–µ—Ç `select_exact` | –ü–µ—Ä–µ–¥–∞–π –ø–æ–ª–Ω–æ–µ –∏–º—è –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ |
| Review –Ω–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ | –ü–æ–∏—Å–∫ –ø–æ `company_id` –¥–æ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ | –ò—â–∏ —Ç–æ–ª—å–∫–æ –ø–æ `author_name` |
| 401 –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞ | –ù–µ–≤–µ—Ä–Ω—ã–µ –∫—Ä–µ–¥—ã –∞–¥–º–∏–Ω–∞ | `Philippe_testeroni` (–∑–∞–≥–ª–∞–≤–Ω–∞—è P!) |

### Debug –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–º–µ–¥–ª–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ 1 —Å–µ–∫—É–Ω–¥—ã
pytest tests/test_guides.py --slow-mo=1000 -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä
pytest tests/test_lookup.py -k "company" -v

# Playwright debug mode
PLAYWRIGHT_DEBUG=1 pytest tests/test_guides.py -v

# –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
pytest tests/ -v -s

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–º –ø–∞–¥–µ–Ω–∏–∏
pytest tests/ -x
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ cleanup

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å –≤ –ë–î
curl http://localhost:8000/api/v1/test/reviews/all | jq '.reviews | length'
curl http://localhost:8000/api/v1/test/companies/all | jq '.companies | length'
curl http://localhost:8000/api/v1/test/guides/all | jq '.guides | length'
```

---

## –ß–µ–∫–ª–∏—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–∞ ‚úÖ

–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—å:

- [ ] –°–µ–ª–µ–∫—Ç–æ—Ä—ã –≤–∑—è—Ç—ã –∏–∑ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞?
- [ ] –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞ –≤ Page Object?
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã –∏–∑ `BasePage` (`wait_for_load`, `click_and_wait`, `fill_and_validate`)?
- [ ] –ú–∞—Ä–∫–µ—Ä—ã `@pytest.mark.e2e`, `@pytest.mark.critical`?
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–∏–∫—Å—Ç—É—Ä—ã cleanup (`clean_test_review`, etc.)?
- [ ] –ü–æ–Ω—è—Ç–Ω—ã–µ assert —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏?
- [ ] –¢–µ—Å—Ç –ª–∏–Ω–µ–π–Ω—ã–π (–Ω–µ—Ç `if/else` –∫—Ä–æ–º–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏)?
- [ ] –ù–µ—Ç `time.sleep()` (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `wait_for_*`)?
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ `frontend_api_client` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏?
- [ ] Cleanup –≤ —Ñ–∏–∫—Å—Ç—É—Ä–∞—Ö, –∞ –Ω–µ –≤ —Ç–µ–ª–µ —Ç–µ—Å—Ç–∞?
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `wait_for_condition` –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è (–Ω–µ hard reload)?

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

1. ‚úÖ `data-testid` (–ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç)
2. ‚úÖ `id`
3. ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π `className`
4. ‚úÖ `name` (–¥–ª—è —Ñ–æ—Ä–º)
5. ‚ö†Ô∏è `text` (–ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç, —Ö—Ä—É–ø–∫–∏–π)

```python
# –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
SUBMIT_BTN = "[data-testid='submit-review']"          # data-testid
EMAIL_INPUT = "input[name='email']"                    # name
DROPDOWN = "div.absolute.z-10[class*='bg-']"          # —É–Ω–∏–∫–∞–ª—å–Ω—ã–π className
LEAVE_REVIEW_BTN = "button:has-text('–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤')" # text (–µ—Å–ª–∏ –Ω–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã)
SUCCESS_ALERT = ".bg-green-100"                        # className
```

**–ò–∑–±–µ–≥–∞–π:**
- –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ XPath (`/html/body/div[2]/div[1]...`)
- –°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –∫–ª–∞—Å—Å–æ–≤
- –°–µ–ª–µ–∫—Ç–æ—Ä—ã, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã DOM

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Playwright Docs:** https://playwright.dev/python/
- **pytest-playwright:** https://github.com/microsoft/playwright-pytest
- **Frontend Repo:** `/Users/philippkochnov/PycharmProjects/hikers/frontend`
- **Backend Repo:** `/Users/philippkochnov/PycharmProjects/hikers/backend`

---

**–í–µ—Ä—Å–∏—è:** 3.2.0  
**–î–∞—Ç–∞:** 05.10.2025  
**–ê–≤—Ç–æ—Ä:** Philippe Kochnov  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ wait_for_data_update ‚Üí wait_for_condition. –£–¥–∞–ª—ë–Ω CDP hard reload, –¥–æ–±–∞–≤–ª–µ–Ω –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ã—á–Ω—ã–π reload –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä retry_with_reload=True –¥–ª—è ISR –∫–µ—à–∞. –¢–µ—Å—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è retry —Å reload.
