# Hiker's Voice - –°–∏—Å—Ç–µ–º–∞ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–ú–∏–Ω–∏–º—É–º —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è, –º–∞–∫—Å–∏–º—É–º —è—Å–Ω–æ—Å—Ç–∏. –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º–∏ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –ø—É—à–µ–º –≤ –ø—Ä–æ–¥. –ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –∏ –ø–µ—Ä–µ—É—Å–ª–æ–∂–Ω–µ–Ω–∏–π.

## –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤ ‚úÖ

| –¢–µ—Å—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª |
|------|----------|--------|------|
| TEST-001 | –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–æ–º | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | `test_reviews.py::test_create_company_review_with_autocomplete` |
| TEST-002 | –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –≥–∏–¥–∞ —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–æ–º | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | `test_reviews.py::test_create_guide_review_with_autocomplete` |
| TEST-004 | –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–∞ (–∫–æ–º–ø–∞–Ω–∏—è –∏ –≥–∏–¥) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | `test_reviews.py::test_review_form_validation_errors` |

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### TEST-001: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–æ–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–∞ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–º–ø–∞–Ω–∏–∏ "Svaneti"
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–π API
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç–∑—ã–≤–∞
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ (1-5)

### TEST-002: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –≥–∏–¥–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –≥–∏–¥–∞ "–ì–µ–æ—Ä–≥–∏–π –ß–µ–ª–∏–¥–∑–µ"
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≥–∏–¥–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –æ—Ç–∑—ã–≤–∞ –∫ –≥–∏–¥—É —á–µ—Ä–µ–∑ EntityLinker
- ‚úÖ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ —Å —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å—é 0.05
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ç—Ä—ë—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö: –≥–∏–¥–∞, –≥–ª–∞–≤–Ω–æ–π –∏ /reviews
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ –∑–≤—ë–∑–¥ –≤ –æ—Ç–∑—ã–≤–∞—Ö

### TEST-004: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç)
- ‚úÖ **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** –¢–µ—Å—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º—ã –∫–æ–º–ø–∞–Ω–∏–∏ –ò —Ñ–æ—Ä–º—ã –≥–∏–¥–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–Ω–æ–ø–∫–∏ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å" –ø—Ä–∏ –ø—É—Å—Ç–æ–π —Ñ–æ—Ä–º–µ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ –æ—Ç–∑—ã–≤–∞ (10 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ –æ—Ç–∑—ã–≤–∞ (4000 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∞–≤–∏–ª –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- ‚úÖ –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º—ã: –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π –≤–ª–∏—è—é—Ç –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–π —Ñ–æ—Ä–º–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ TEST-004:**
```python
@pytest.mark.parametrize("review_type,entity_field_placeholder", [
    ("company", "–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏"),
    ("guide", "–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∏–º—è –≥–∏–¥–∞"),
])
```
–û–¥–∏–Ω —Ç–µ—Å—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –æ–±–µ–∏—Ö —Ñ–æ—Ä–º, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã.

## –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã üîß

### 1. –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏–≤—è–∑–∫–∏ –æ—Ç–∑—ã–≤–æ–≤ –∫ –≥–∏–¥–∞–º

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª —Å–≤—è–∑–∏ –º–µ–∂–¥—É –æ—Ç–∑—ã–≤–æ–º –∏ –≥–∏–¥–æ–º/–∫–æ–º–ø–∞–Ω–∏–µ–π.

**–†–µ—à–µ–Ω–∏–µ:** –¢–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/v1/test/moderate/{review_id}` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ReviewService.approve_review()` –∫–æ—Ç–æ—Ä—ã–π:
- –í—ã–∑—ã–≤–∞–µ—Ç EntityLinker –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–≤—è–∑–µ–π
- –°–æ–∑–¥–∞–µ—Ç/–Ω–∞—Ö–æ–¥–∏—Ç –≥–∏–¥–∞ –∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏—é
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥–∏
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ review_guide (many-to-many)

**–§–∞–π–ª —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏:** `/backend/app/api/test_moderation.py`

### 2. –ü–æ–¥—Å—á—ë—Ç –∑–≤—ë–∑–¥ –≤ –æ—Ç–∑—ã–≤–∞—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Rating –≤—Å–µ–≥–¥–∞ —Ä–µ–Ω–¥–µ—Ä–∏—Ç 5 SVG —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ.

**–†–µ—à–µ–Ω–∏–µ:** 
```python
filled_stars = await review_element.locator("svg.text-yellow-400").count()
```

### 3. –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** Backend –æ–∫—Ä—É–≥–ª—è–µ—Ç –¥–æ 1 –¥–µ—Å—è—Ç–∏—á–Ω–æ–≥–æ –∑–Ω–∞–∫–∞, —Ç–µ—Å—Ç—ã –æ–∂–∏–¥–∞–ª–∏ —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å 0.05 –≤ –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö —Ä–µ–π—Ç–∏–Ω–≥–∞.

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º —Å react-hook-form

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–æ—Ä–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∂–∏–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `onChange`, –æ—à–∏–±–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ `blur` —Å–æ–±—ã—Ç–∏—è.

**–†–µ—à–µ–Ω–∏–µ:** 
```python
await text_area_locator.fill("–ö–æ—Ä–æ—Ç–∫–∏–π")
await text_area_locator.blur()  # –¢—Ä–∏–≥–≥–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏
await page.wait_for_timeout(500)
# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
hikers_voice_tests/
‚îú‚îÄ‚îÄ conftest.py              # –ì–ª–∞–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ pytest.ini               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ pytest
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ README.MD               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îÇ
‚îú‚îÄ‚îÄ pages/                   # Page Objects –ø–∞—Ç—Ç–µ—Ä–Ω
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py         
‚îÇ   ‚îú‚îÄ‚îÄ base_page.py        # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å –æ–±—â–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ home_page.py        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ review_form_page.py # –§–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ guide_page.py       # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–∏–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ reviews_page.py     # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py         # E2E –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ test_reviews.py     # –¢–µ—Å—Ç—ã –æ—Ç–∑—ã–≤–æ–≤ TEST-001, TEST-002, TEST-004
‚îÇ
‚îú‚îÄ‚îÄ fixtures/                # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ test_data.py        # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îî‚îÄ‚îÄ utils/                   # –£—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ test_helper.py      # API —Ö–µ–ª–ø–µ—Ä—ã –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
    ‚îî‚îÄ‚îÄ rating_calculator.py # –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
```

## –¢–µ—Å—Ç–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã Backend

–í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `/backend/app/api/test_moderation.py` –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `GET /api/v1/test/reviews/all` - –≤—Å–µ –æ—Ç–∑—ã–≤—ã —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–≤—è–∑—è—Ö
- `POST /api/v1/test/moderate/{review_id}` - –º–æ–¥–µ—Ä–∞—Ü–∏—è —Å –ø–æ–ª–Ω—ã–º EntityLinker
- `GET /api/v1/test/reviews/{review_id}/diagnostic` - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–≤—è–∑–µ–π –æ—Ç–∑—ã–≤–∞

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- `POST /api/v1/test/moderate/{review_id}/edit` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–¥–æ–±—Ä–µ–Ω–∏–µ
- `POST /api/v1/test/moderate/{review_id}/ban-ip` - –±–∞–Ω IP
- `POST /api/v1/test/moderate/{review_id}/mute-ip` - –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º—å—é—Ç IP
- `POST /api/v1/test/moderate/{review_id}/allow-ip` - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ IP –∏ –æ–¥–æ–±—Ä–µ–Ω–∏–µ

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
- `DELETE /api/v1/test/reviews/{review_id}` - —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
- `DELETE /api/v1/test/companies/{company_id}` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
pytest tests/test_reviews.py::test_create_guide_review_with_autocomplete -v

# –ó–∞–ø—É—Å–∫ TEST-004 –¥–ª—è –æ–±–µ–∏—Ö —Ñ–æ—Ä–º
pytest tests/test_reviews.py::test_review_form_validation_errors -v

# –ó–∞–ø—É—Å–∫ TEST-004 —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–æ—Ä–º—ã –∫–æ–º–ø–∞–Ω–∏–∏
pytest tests/test_reviews.py::test_review_form_validation_errors[company] -v

# –ó–∞–ø—É—Å–∫ TEST-004 —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–æ—Ä–º—ã –≥–∏–¥–∞
pytest tests/test_reviews.py::test_review_form_validation_errors[guide] -v

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –æ—Ç–∑—ã–≤–æ–≤
pytest tests/test_reviews.py -v

# –° –≤–∏–∑—É–∞–ª—å–Ω—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º (–º–µ–¥–ª–µ–Ω–Ω–æ)
pytest tests/test_reviews.py --slow-mo=500

# –í headless —Ä–µ–∂–∏–º–µ (–±—ã—Å—Ç—Ä–æ)
pytest tests/test_reviews.py --headless

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
pytest tests/test_reviews.py -v -s

# –¢–æ–ª—å–∫–æ smoke —Ç–µ—Å—Ç—ã
pytest -m smoke

# –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest -m critical
```

## –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
1. **Backend** –∑–∞–ø—É—â–µ–Ω –Ω–∞ `http://localhost:8000`
2. **Frontend** –∑–∞–ø—É—â–µ–Ω –Ω–∞ `http://localhost:3000`
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** —Å–æ–¥–µ—Ä–∂–∏—Ç seed –¥–∞–Ω–Ω—ã–µ:
   - –ì–∏–¥: –ì–µ–æ—Ä–≥–∏–π –ß–µ–ª–∏–¥–∑–µ (id=1)
   - –ö–æ–º–ø–∞–Ω–∏–∏ —Å "Svaneti" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
4. **–¢–µ—Å—Ç–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** –≤–∫–ª—é—á–µ–Ω—ã (APP_ENV=dev)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Backend
curl http://localhost:8000/healthz

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Frontend
curl http://localhost:3000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
curl http://localhost:8000/api/v1/test/reviews/all
```

## –í–∞–∂–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã

### clean_test_review
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞:
```python
@pytest.fixture
async def clean_test_review(backend_url):
    review_ids = []
    yield review_ids  # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç ID —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
```

### review_test_data
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤:
```python
{
    "valid": {
        "tour_review": {...},
        "guide_review": {...}
    }
}
```

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞ (AAA)
```python
async def test_feature(page: Page, review_test_data: dict):
    # Arrange - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    test_data = review_test_data["valid"]["tour_review"]
    home_page = HomePage(page)
    
    # Act - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
    await home_page.open()
    await home_page.click_leave_review()
    # ... –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã
    
    # Assert - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    assert await home_page.check_review_exists(), "Review not found"
    logger.info(f"TEST-XXX completed: review_id={review_id}")
```

### –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–¥–∞
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ Page Objects
- ‚úÖ **–°–ª–µ–¥—É–π—Ç–µ** –ø–∞—Ç—Ç–µ—Ä–Ω—É AAA (Arrange-Act-Assert)
- ‚úÖ **–î–æ–±–∞–≤–ª—è–π—Ç–µ** –ø–æ–Ω—è—Ç–Ω—ã–µ assert —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ **–õ–æ–≥–∏—Ä—É–π—Ç–µ** —Ç–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —É—Å–ø–µ—Ö —Ç–µ—Å—Ç–∞
- ‚ùå **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ** –Ω–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏
- ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** time.sleep() - —Ç–æ–ª—å–∫–æ wait_for_*
- ‚ùå **–ù–ï —Ö–∞—Ä–¥–∫–æ–¥—å—Ç–µ** –¥–∞–Ω–Ω—ã–µ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã

## –û—Ç–ª–∞–¥–∫–∞

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—Ç–∑—ã–≤–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∏ –æ—Ç–∑—ã–≤–∞
curl http://localhost:8000/api/v1/test/reviews/{review_id}/diagnostic

# –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–∞:
{
  "entity_links": {
    "guide_id (legacy)": 1,
    "guide_name (legacy)": "–ì–µ–æ—Ä–≥–∏–π –ß–µ–ª–∏–¥–∑–µ"
  },
  "linked_guides": [{
    "id": 1,
    "name": "–ì–µ–æ—Ä–≥–∏–π –ß–µ–ª–∏–¥–∑–µ", 
    "is_primary": true
  }],
  "issues": []  # –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ = –≤—Å—ë —Ö–æ—Ä–æ—à–æ
}
```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| –û—Ç–∑—ã–≤ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –≥–∏–¥—É | –°—Ç–∞—Ä—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç | –û–±–Ω–æ–≤–∏—Ç–µ backend, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç |
| –°–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω | –ò–∑–º–µ–Ω–∏–ª—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤ `/frontend/src/components/` |
| –†–µ–π—Ç–∏–Ω–≥ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç | –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å 0.05 |
| Cleanup –ø–∞–¥–∞–µ—Ç | –ù–µ—Ç –ø—Ä–∞–≤ –∏–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–±—ä–µ–∫—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |
| –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ | –î–æ–±–∞–≤—å—Ç–µ `wait_for_timeout(500)` –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ |
| –ú–æ–¥–µ—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | EntityLinker –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ReviewService |
| `wait_for_review_form()` –ø–∞–¥–∞–µ—Ç | –ú–µ—Ç–æ–¥ –∂–¥—ë—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ –∫–æ–º–ø–∞–Ω–∏–∏ | –ñ–¥–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –ø–æ–ª–µ –Ω–∞–ø—Ä—è–º—É—é: `page.wait_for_selector()` |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | –§–æ—Ä–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç onChange —Ä–µ–∂–∏–º | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.blur()` –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |

### –ó–∞–ø—É—Å–∫ —Å –æ—Ç–ª–∞–¥–∫–æ–π
```bash
# –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Å –ø–∞—É–∑–∞–º–∏
pytest tests/test_reviews.py --slow-mo=1000 --headed

# –° –≤—ã–≤–æ–¥–æ–º –≤—Å–µ—Ö –ª–æ–≥–æ–≤
pytest tests/test_reviews.py -v -s --log-cli-level=INFO

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç —Å –æ—Ç–ª–∞–¥–∫–æ–π
pytest tests/test_reviews.py::test_create_guide_review_with_autocomplete -vvv
```

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- [ ] TEST-003: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ —Å –Ω–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–µ–π (–Ω–µ –∏–∑ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞)
- [ ] TEST-005: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ —Å –Ω–æ–≤—ã–º –≥–∏–¥–æ–º (–Ω–µ –∏–∑ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞)
- [ ] TEST-006: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º
- [ ] TEST-007: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ –ø–æ —Å—Ç—Ä–∞–Ω–µ
- [ ] TEST-008: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∫ –æ—Ç–∑—ã–≤—É
- [ ] –¢–µ—Å—Ç—ã –¥–ª—è many-to-many —Å–≤—è–∑–µ–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–∏–¥–æ–≤ –≤ –æ—Ç–∑—ã–≤–µ)
- [ ] –¢–µ—Å—Ç—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏ IP (–±–∞–Ω/–º—å—é—Ç)
- [ ] API —Ç–µ—Å—Ç—ã –±–µ–∑ UI

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥
- [ ] –í—ã–Ω–µ—Å—Ç–∏ URL –≤ environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- [ ] –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- [ ] –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –æ—Ç—á—ë—Ç–æ–≤

---

**–ü—Ä–∏–Ω—Ü–∏–ø –ø—Ä–æ–µ–∫—Ç–∞:** –ü—Ä–æ—Å—Ç—ã–µ, –Ω–∞–¥—ë–∂–Ω—ã–µ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏ –∏ –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –û–∫—Ç—è–±—Ä—å 2024
**–í–µ—Ä—Å–∏—è:** 1.3.0
